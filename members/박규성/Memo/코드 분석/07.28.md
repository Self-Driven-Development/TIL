# 23.07.28(금)

## 1. `useInput` 훅
### 핵심
1. `useCallback`과 `useMemo`를 사용하여 리렌더링 최적화
2. `lodash`를 이용하여 `debounce` 적용
```js
import { ChangeEvent, useCallback, useMemo, useState } from 'react';
import debounce from 'lodash/debounce';

export interface UseInputHookType {
  /**
   * input state가 initializing 될 때 넣을 값입니다.
   *
   * @default ''
   */
  initialValue?: string;

  /**
   * debounce 효과를 사용할 것인지 정의합니다.
   *
   * @default `false`
   */
  useDebounce?: boolean;

  /**
   * debounce 효과를 사용할 때의 timeout 시간입니다. (단위: ms)
   *
   * @default `150`
   */
  debounceTimeout?: number;
}

type InputAcceptType = string;

export default function useInput({
  initialValue,
  useDebounce = false,
  debounceTimeout = 150,
}: UseInputHookType) {
  const [value, setValue] = useState<InputAcceptType>(initialValue ?? '');
  const [debouncedValue, setDebouncedValue] = useState<InputAcceptType>(initialValue ?? '');

  const handleSetDebounceValue = useMemo(
    () =>
      debounce((value: string) => {
        setDebouncedValue(value);
      }, debounceTimeout),
    [debounceTimeout]
  );

  const handleSetValue = useCallback(
    (value: InputAcceptType) => {
      setValue(value);
      if (useDebounce) {
        handleSetDebounceValue(value);
      }
    },
    [handleSetDebounceValue, useDebounce]
  );

  const onChange = useCallback(
    (event: ChangeEvent<HTMLInputElement> | ChangeEvent<HTMLTextAreaElement>) => {
      handleSetValue(event.target.value);
    },
    [handleSetValue]
  );

  return {
    value,

    setValue: handleSetValue,

    /**
     * input 요소의 onChange 를 처리하는 함수입니다.
     *
     * ```js
     * <input value={...} onChange={onChange} />
     * ```
     */
    onChange,

    /**
     * value를 debounce한 string입니다.
     *
     * `useDebounce`가 `true`로 설정되어 있어야 작동합니다.
     */
    debouncedValue,
  };
}

```
- `debounceTimeout`의 default값은 150

```js
const onChange = useCallback(
  (event: ChangeEvent<HTMLInputElement> | ChangeEvent<HTMLTextAreaElement>) => {
    handleSetValue(event.target.value);
  },
  [handleSetValue]
);
```
- `onChange`함수는 `useCallback`으로 감싸져서 `useInput`훅을 사용하는 컴포넌트가 리렌더링 될 때마다 새로운 함수를 생성하지 않는다.

```js
const handleSetValue = useCallback(
  (value: InputAcceptType) => {
    setValue(value);
    if (useDebounce) {
      handleSetDebounceValue(value);
    }
  },
  [handleSetDebounceValue, useDebounce]
);
```
- `handleSetValue` 함수 또한 `useCallback`으로 감싸져있다.
- `useInput`을 호출 할 때 넘겨준 `useDebouce`의 값이 `true`라면, loash의 `debounace()`를 실행시켜 `debouncedValue`를 업데이트한다.
